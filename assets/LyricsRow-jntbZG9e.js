import{r as c,u as L,j as t,i as A}from"./index-XT8WscD4.js";import{s as _}from"./Lyrics_sample-DbaoSwNR.js";import{N as w,P as j}from"./Normal_Button-c7XoY3fi.js";import{F,a as M}from"./index-CGBS4Xg_.js";import{C as z}from"./index-BOPqhepm.js";import{M as E}from"./MessagePopup-yaKOPx-m.js";import{b as P}from"./index-CF2s9ET1.js";const Y=(e=768)=>{const[s,i]=c.useState(window.innerWidth<e);return c.useEffect(()=>{const n=()=>i(window.innerWidth<e);return window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[e]),s},V=({id:e,lyric:s})=>{const[i,n]=c.useState(!1),[d,a]=c.useState(""),[o,r]=c.useState(!1),l=()=>r(!1);c.useEffect(()=>{l()},[]);const f=L(),u=()=>{console.log("Go to Lyrics Details"),f(`/NT_Lyrics/lyricsdetail/${e}`,{state:{lyric:s}})},m=()=>{a(o?"Lyrics has been removed from the collection":"Lyrics has been added to the collection"),r(!o),n(!0),setTimeout(()=>{n(!1)},2e3)};return t.jsxs(t.Fragment,{children:[i&&t.jsx(E,{message_type:"success",message_text:d}),t.jsxs("div",{className:"relative card w-full min-h-32 aspect-[4/5] rounded-md shadow-md overflow-hidden",onClick:u,children:[t.jsx("img",{src:_,className:"w-full"}),t.jsx("div",{className:"gradient-overlay w-full h-full absolute bottom-0"}),t.jsxs("div",{className:"flex justify-between w-full absolute bottom-0 p-2 px-4",children:[t.jsxs("div",{className:"flex items-center gap-1 font-semibold",children:[t.jsx(F,{size:16,className:"translate-y-[1px]"})," ",t.jsx("span",{className:"viewCount",children:(s==null?void 0:s.view_count)??"1"})]}),o?t.jsx(w,{icon:z,text:"Remove from Collection",custom_class:"py-1 px-3 border-transparent shadow-sm bg-red-50 text-red-500",onClick:m}):t.jsx(w,{icon:M,text:"Add to collection",custom_class:"py-1 px-3 border-transparent shadow-sm bg-white",onClick:m})]})]})]})};V.propTypes={id:j.string.isRequired,lyric:j.object};var C=new Map,b=new WeakMap,T=0,B=void 0;function O(e){return e?(b.has(e)||(T+=1,b.set(e,T.toString())),b.get(e)):"0"}function $(e){return Object.keys(e).sort().filter(s=>e[s]!==void 0).map(s=>`${s}_${s==="root"?O(e.root):e[s]}`).toString()}function D(e){const s=$(e);let i=C.get(s);if(!i){const n=new Map;let d;const a=new IntersectionObserver(o=>{o.forEach(r=>{var l;const f=r.isIntersecting&&d.some(u=>r.intersectionRatio>=u);e.trackVisibility&&typeof r.isVisible>"u"&&(r.isVisible=f),(l=n.get(r.target))==null||l.forEach(u=>{u(f,r)})})},e);d=a.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),i={id:s,observer:a,elements:n},C.set(s,i)}return i}function W(e,s,i={},n=B){if(typeof window.IntersectionObserver>"u"&&n!==void 0){const l=e.getBoundingClientRect();return s(n,{isIntersecting:n,target:e,intersectionRatio:typeof i.threshold=="number"?i.threshold:0,time:0,boundingClientRect:l,intersectionRect:l,rootBounds:l}),()=>{}}const{id:d,observer:a,elements:o}=D(i),r=o.get(e)||[];return o.has(e)||o.set(e,r),r.push(s),a.observe(e),function(){r.splice(r.indexOf(s),1),r.length===0&&(o.delete(e),a.unobserve(e)),o.size===0&&(a.disconnect(),C.delete(d))}}function q({threshold:e,delay:s,trackVisibility:i,rootMargin:n,root:d,triggerOnce:a,skip:o,initialInView:r,fallbackInView:l,onChange:f}={}){var u;const[m,y]=c.useState(null),g=c.useRef(f),[x,p]=c.useState({inView:!!r,entry:void 0});g.current=f,c.useEffect(()=>{if(o||!m)return;let v;return v=W(m,(R,S)=>{p({inView:R,entry:S}),g.current&&g.current(R,S),S.isIntersecting&&a&&v&&(v(),v=void 0)},{root:d,rootMargin:n,threshold:e,trackVisibility:i,delay:s},l),()=>{v&&v()}},[Array.isArray(e)?e.toString():e,m,d,n,a,o,i,l,s]);const I=(u=x.entry)==null?void 0:u.target,N=c.useRef(void 0);!m&&I&&!a&&!o&&N.current!==I&&(N.current=I,p({inView:!!r,entry:void 0}));const h=[y,x.inView,x.entry];return h.ref=h[0],h.inView=h[1],h.entry=h[2],h}const H=({id:e,lyric:s})=>{var x;const[i,n]=c.useState(!1),[d,a]=c.useState(""),[o,r]=c.useState(!1),{ref:l,inView:f}=q({triggerOnce:!0,threshold:.1}),u=()=>r(!1);c.useEffect(()=>{u()},[]);const m=L(),y=()=>{m(`/NT_Lyrics/lyricsdetail/${e}`,{state:{lyric:s}})},g=()=>{a(o?"Lyrics has been removed from the collection":"Lyrics has been added to the collection"),r(!o),n(!0),setTimeout(()=>{n(!1)},2e3)};return t.jsxs(t.Fragment,{children:[i&&t.jsx(E,{message_type:"success",message_text:d}),t.jsxs(A.div,{className:"relative flex items-center w-full border-b last:border-0  border-dashed border-gray-200",onClick:y,ref:l,initial:{scale:0,opacity:0,x:0},animate:f?{scale:1,opacity:1,y:0}:{},transition:{duration:.4},children:[t.jsx("img",{src:_,className:"w-12 h-12 object-contain"}),t.jsxs("div",{className:"flex justify-between items-center w-full p-2 pl-4",children:[t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsx("p",{className:"font-semibold",children:(s==null?void 0:s.title)??"Sample Title"}),t.jsx("p",{className:"text-sm text-gray-500",children:((x=s==null?void 0:s.artist)==null?void 0:x.join(", "))??"Sample Artist"})]}),o?t.jsx(w,{icon:P,text:"",custom_class:"w-8 h-8 border-transparent shadow-sm bg-red-50 text-red-500 transition-all",onClick:p=>{p.stopPropagation(),g()}}):t.jsx(w,{icon:M,text:"",custom_class:"w-8 h-8 border-transparent shadow-sm bg-white transition-all",onClick:p=>{p.stopPropagation(),g()}})]})]})]})};H.propTypes={id:j.string.isRequired,lyric:j.object};export{H as L,V as a,Y as u};
